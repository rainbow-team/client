<div style="height: 100%;background:#fff">
  <!-- <div class="div_top_add">
    核设施信息
  </div> -->

  <nz-tabset>
    <nz-tab nzTitle="核设施信息">
      <div class="div_contain_add" style="    height: calc(100% - 430px);">
        <div nz-row class="ma_b20">
          <div nz-col [nzSpan]="8" class="ta_r">
            <span class="clo_r">*</span>核设施名称：
            <input nz-input name="name" [(ngModel)]="data.name" class="w200" required [validation]="true"
              [disabled]="isDisable" />
          </div>
          <div nz-col [nzSpan]="8" class="ta_r">
            核设施编号：
            <input nz-input name="code" [(ngModel)]="data.code" class="w200" [disabled]="isDisable" />
          </div>
          <div nz-col [nzSpan]="8" class="ta_r">
            <span class="clo_r">*</span>营运单位：
            <nz-select [(ngModel)]="data.serviceId" class="w200" required [validation]="true" [disabled]="isDisable">
              <nz-option *ngFor="let option of ServiceDepartList" [nzLabel]="option.name" [nzValue]="option.id">
              </nz-option>
            </nz-select>
          </div>
        </div>

        <div nz-row class="ma_b20">
          <div nz-col [nzSpan]="8" class="ta_r">
            参建单位：
            <input nz-input name="builder" [(ngModel)]="builder" class="w200" [disabled]="isDisable" />
          </div>
          <div nz-col [nzSpan]="8" class="ta_r">
            建造年代：
            <nz-year-picker class="w200" [(ngModel)]="data.buildYear" [disabled]="isDisable"></nz-year-picker>
          </div>
          <div nz-col [nzSpan]="8" class="ta_r">
            <span class="clo_r">*</span>监管类别：
            <nz-select [(ngModel)]="data.serviceId" class="w200" required [validation]="true" [disabled]="isDisable">
              <nz-option *ngFor="let option of dictionary.config_fac_supervison_category" [nzLabel]="option.value"
                [nzValue]="option.id">
              </nz-option>
            </nz-select>
          </div>
        </div>

        <div nz-row class="ma_b20">
          <div nz-col [nzSpan]="8" class="ta_r">
            <span class="clo_r">*</span>设施类型：
            <nz-select [(ngModel)]="data.typeId" class="w200" required [validation]="true" [disabled]="isDisable">
              <nz-option *ngFor="let option of dictionary.config_fac_type" [nzLabel]="option.value"
                [nzValue]="option.id">
              </nz-option>
            </nz-select>
          </div>
          <div nz-col [nzSpan]="8" class="ta_r">
            <span class="clo_r">*</span>设施状态：
            <nz-select [(ngModel)]="data.statusId" class="w200" required [validation]="true" [disabled]="isDisable">
              <nz-option *ngFor="let option of dictionary.config_fac_status" [nzLabel]="option.value"
                [nzValue]="option.id">
              </nz-option>
            </nz-select>
          </div>
          <div nz-col [nzSpan]="8" class="ta_r">
            <span class="clo_r">*</span>审评状态：
            <nz-select [(ngModel)]="data.reviewStatusId" class="w200" required [validation]="true"
              [disabled]="isDisable">
              <nz-option *ngFor="let option of dictionary.config_review_status" [nzLabel]="option.value"
                [nzValue]="option.id">
              </nz-option>
            </nz-select>
          </div>
        </div>

        <div nz-row class="ma_b20">
          <div nz-col [nzSpan]="8" class="ta_r">
            <span class="clo_r">*</span>许可情况：
            <nz-select [(ngModel)]="data.facPermitSituationId" class="w200" required [validation]="true"
              [disabled]="isDisable">
              <nz-option *ngFor="let option of dictionary.config_fac_permit_situation" [nzLabel]="option.value"
                [nzValue]="option.id">
              </nz-option>
            </nz-select>
          </div>
          <div nz-col [nzSpan]="8" class="ta_r">
            <span class="clo_r">*</span>是否满足抗震设防等级：
            <nz-select [(ngModel)]="data.isEarthquake" class="w200" required [validation]="true" [disabled]="isDisable">
              <nz-option *ngFor="let option of sFList" [nzLabel]="option.value" [nzValue]="option.id">
              </nz-option>
            </nz-select>
          </div>
          <div nz-col [nzSpan]="8" class="ta_r">
            <span class="clo_r">*</span>是否满足防洪要求：
            <nz-select [(ngModel)]="data.isFlood" class="w200" required [validation]="true" [disabled]="isDisable">
              <nz-option *ngFor="let option of sFList" [nzLabel]="option.value" [nzValue]="option.id">
              </nz-option>
            </nz-select>
          </div>
        </div>

        <div nz-row class="ma_b20">
          <div nz-col [nzSpan]="8" class="ta_r">
            工作人员剂量约束：
            <input nz-input name="measure" [(ngModel)]="data.measure" class="w200" [disabled]="isDisable" />
          </div>
        </div>

        <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
          <div nz-col [nzSpan]="24" class="ta_r">
            <div class="div_bz">设施简介：</div>
            <textarea nz-input name="survey" style="width: calc(100% - 130px);height: 70px;" [(ngModel)]="data.survey"
              [disabled]="isDisable"></textarea>
          </div>
        </div>

        <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
          <div nz-col [nzSpan]="24" class="ta_r">
            <div class="div_bz">厂址特征：</div>
            <textarea nz-input name="feature" style="width: calc(100% - 130px);height: 70px;" [(ngModel)]="data.feature"
              [disabled]="isDisable"></textarea>
          </div>
        </div>

        <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
          <div nz-col [nzSpan]="24" class="ta_r">
            <div class="div_bz">工艺描述：</div>
            <textarea nz-input name="techDes" style="width: calc(100% - 130px);height: 70px;" [(ngModel)]="data.techDes"
              [disabled]="isDisable"></textarea>
          </div>
        </div>

        <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
          <div nz-col [nzSpan]="24" class="ta_r">
            <div class="div_bz">设计基准事故：</div>
            <textarea nz-input name="designStandardAccident" style="width: calc(100% - 130px);height: 70px;"
              [(ngModel)]="data.designStandardAccident" [disabled]="isDisable"></textarea>
          </div>
        </div>

        <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
          <div nz-col [nzSpan]="24" class="ta_r">
            <div class="div_bz">备注：</div>
            <textarea nz-input name="note" style="width: calc(100% - 130px);height: 70px;" [(ngModel)]="data.note"
              [disabled]="isDisable"></textarea>
          </div>
        </div>

        <app-attachment [fileList]="fileList" [refid]="data.id" [isDisable]="isDisable"></app-attachment>

      </div>
    </nz-tab>

    <nz-tab nzTitle="安技改信息" *ngIf="isDisable">
      <div style="padding: 0 30px;">
        <div nz-row>
          <nz-table #nestedTable [nzData]="dataSet" class="commontable" [nzFrontPagination]="false"
            [nzTotal]="totalCount" [nzPageIndex]="pageIndex" nzShowSizeChanger [nzPageSize]="pageSize"
            (nzPageIndexChange)="pageIndexChange($event)" class="tablescoll_rainbow">
            <thead>
              <tr>
                <th>序号</th>
                <th>安技改时间</th>
                <th>安技改内容</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of nestedTable.data;index as index ">
                <td>{{(pageIndex-1)*pageSize+1+index}}</td>
                <td>{{data.improveDate|recordtime}}</td>
                <td>{{data.improveContent}}</td>
              </tr>
            </tbody>
          </nz-table>

        </div>
      </div>
    </nz-tab>

    <nz-tab nzTitle="定期报告信息" *ngIf="isDisable">
      <div style="padding: 0 30px;">
        <div nz-row>
          <nz-table #nestedTable1 [nzData]="dataSetReport" class="commontable tablescoll_rainbow"
            [nzFrontPagination]="false" [nzPageIndex]="pageIndexReport" nzShowSizeChanger [nzPageSize]="pageSizeReport"
            [nzTotal]="totalCountReport" (nzPageIndexChange)="pageIndexChangeReport($event)"
            (nzPageSizeChange)="pageSizeChangeReport($event)">
            <thead>
              <tr>
                <th>序号</th>
                <th>定期报告类别</th>
                <th>定期报告时间</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of nestedTable1.data;index as index">
                <td>{{(pageIndex-1)*pageSize+1+index}}</td>
                <td>{{data.reportTypeValue}}</td>
                <td>{{data.date|recordtime}}</td>
              </tr>
            </tbody>
          </nz-table>

        </div>
      </div>
    </nz-tab>


  </nz-tabset>


  <div nz-row [nzType]="'flex'" [nzAlign]="'middle'" class="div_bottom_add" [nzJustify]="'end'">
    <button nz-button nzType="primary" (click)="save()" *ngIf="!isDisable" style="margin-right: 10px;"
      [nzLoading]="isSaving">保存</button>
    <button nz-button nzType="default" (click)="close()">关闭</button>
  </div>
</div>