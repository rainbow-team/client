<div style="height: 100%;background:#fff">
  <div class="div_top_add">
    核活动许可信息
  </div>
  <div class="div_contain_add" *ngIf="isShow == false" [appPageHeight]='300'>
    <div nz-row class="ma_b20" [nzType]="'flex'" [nzJustify]="'center'">
      <nz-radio-group [(ngModel)]="activityType">
        <label nz-radio nzValue="fac">核设施营运单位</label>
        <label nz-radio nzValue="equip">核设备单位</label>
      </nz-radio-group>
    </div>

    <div nz-row class="ma_b20" *ngIf="activityType === 'fac'">
      <div nz-col [nzSpan]="4" class="ta_r">
        <span class="clo_r">*</span>核设施营运单位：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <nz-select
          [(ngModel)]="data.serviceId"
          style="width: 100%"
          required
          [validation]="true"
          (ngModelChange)="serviceDepartChange($event)"
          nzShowSearch
          required
          nzAllowClear
        >
          <nz-option
            *ngFor="let option of serviceDepartList"
            [nzLabel]="option.name"
            [nzValue]="option.id"
          >
          </nz-option>
        </nz-select>
      </div>

      <div nz-col [nzSpan]="4" class="ta_r">
        核设施：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <nz-select
          [(ngModel)]="data.facId"
          style="width: 100%"
        >
          <nz-option
            *ngFor="let option of facList"
            [nzLabel]="option.name"
            [nzValue]="option.id"
          >
          </nz-option>
        </nz-select>
      </div>
    </div>

    <div nz-row class="ma_b20" *ngIf="activityType === 'equip'">
      <div nz-col [nzSpan]="4" class="ta_r">
        <span class="clo_r">*</span>核设备单位：
      </div>
      <div nz-col [nzSpan]="20" class="ta_l">
        <nz-select
          [(ngModel)]="data.equipDepartId"
          style="width: 100%"
          required
          [validation]="true"
        >
          <nz-option
            *ngFor="let option of equipDepartList"
            [nzLabel]="option.name"
            [nzValue]="option.id"
          >
          </nz-option>
        </nz-select>
      </div>
    </div>

    <div nz-row class="ma_b20">
      <div nz-col [nzSpan]="4" class="ta_r">
        <span class="clo_r">*</span>许可名称：
      </div>
      <div nz-col [nzSpan]="20" class="ta_l">
        <input
          nz-input
          name="name"
          [(ngModel)]="data.name"
          required
          [validation]="true"  [validationType]="'maxlength'" [validationLenth]="50"
        />
      </div>
    </div>

    <div nz-row class="ma_b20">
      <div nz-col [nzSpan]="4" class="ta_r">
        <span class="clo_r">*</span>活动类型：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <nz-select
          [(ngModel)]="data.activityTypeId"
          style="width: 100%"
          required
          [validation]="true"
        >
          <nz-option
            *ngFor="let option of dictionary.config_activity_type"
            [nzLabel]="option.value"
            [nzValue]="option.id"
          >
          </nz-option>
        </nz-select>
      </div>

      <div nz-col [nzSpan]="4" class="ta_r">
        <span class="clo_r">*</span>许可时间：
      </div>
      <div nz-col [nzSpan]="4" class="ta_l">
        <nz-date-picker
          name="permitDate"
          [(ngModel)]="data.permitDate"
          required
          [validation]="true"
        >
        </nz-date-picker>
      </div>
    </div>

    <div nz-row class="ma_b20">
      <div nz-col [nzSpan]="4" class="ta_r">
        有效期限：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <nz-date-picker
          name="validateTime"
          [(ngModel)]="data.validateTime"
        ></nz-date-picker>
      </div>

      <div nz-col [nzSpan]="4" class="ta_r">
        <span class="clo_r">*</span>许可文号：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <input 
          nz-input
          name="licence"
          [(ngModel)]="data.licence"
          required
          [validation]="true"  [validationType]="'maxlength'" [validationLenth]="50"
        />
      </div>
    </div>

    <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
      <div nz-col [nzSpan]="4" class="ta_r">
        许可内容：
      </div>
      <div nz-col [nzSpan]="20" class="ta_l">
        <textarea
          nz-input
          name="content"
          [(ngModel)]="data.content"
        ></textarea>
      </div>
    </div>

    <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
      <div nz-col [nzSpan]="4" class="ta_r">
        许可条件：
      </div>
      <div nz-col [nzSpan]="20" class="ta_l">
        <textarea
          nz-input
          name="permitCondition"
          [(ngModel)]="data.permitCondition"
        ></textarea>
      </div>
    </div>

    <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
      <div nz-col [nzSpan]="4" class="ta_r">
        审评承诺：
      </div>
      <div nz-col [nzSpan]="20" class="ta_l">
        <textarea nz-input name="promise" [(ngModel)]="data.promise"></textarea>
      </div>
    </div>

    <app-attachment
      [fileList]="fileList"
      [refid]="data.id"
      [isDisable]="isShow"
      [moduleName]="'核活动许可信息'"
    #child></app-attachment>
  </div>

  <div class="div_contain_add" *ngIf="isShow == true" [appPageHeight]='300'>
    <div
      nz-row
      class="ma_b20"
      [nzType]="'flex'"
      [nzJustify]="'center'"
      *ngIf="!isShow"
    >
      <nz-radio-group [(ngModel)]="activityType">
        <label nz-radio nzValue="fac">核设施</label>
        <label nz-radio nzValue="equip">核设备</label>
      </nz-radio-group>
    </div>

    <div nz-row class="ma_b20" *ngIf="activityType === 'fac'">
      <div nz-col [nzSpan]="4" class="ta_r">
        核设施营运单位：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <span name="serviceDepartName" class="showText">{{
          data.serviceDepartName
        }}</span>
      </div>

      <div nz-col [nzSpan]="4" class="ta_r">
        核设施信息：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <span name="facName" class="showText">{{ data.facName }}</span>
      </div>
    </div>

    <div nz-row class="ma_b20" *ngIf="activityType === 'equip'">
      <div nz-col [nzSpan]="4" class="ta_r">
        核设备单位：
      </div>
      <div nz-col [nzSpan]="20" class="ta_l">
        <span name="equipDepartName" class="showText">{{
          data.equipDepartName
        }}</span>
      </div>
    </div>

    <div nz-row class="ma_b20">
      <div nz-col [nzSpan]="4" class="ta_r">
        许可名称：
      </div>
      <div nz-col [nzSpan]="20" class="ta_l">
        <span name="name" class="showText">{{ data.name }}</span>
      </div>
    </div>

    <div nz-row class="ma_b20">
      <div nz-col [nzSpan]="4" class="ta_r">
        活动类型：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <span name="typeValue" class="showText">{{ data.typeValue }}</span>
      </div>

      <div nz-col [nzSpan]="4" class="ta_r">
        许可时间：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <span name="permitDate" class="showText">{{
          data.permitDate | recordtime
        }}</span>
      </div>
    </div>

    <div nz-row class="ma_b20">
      <div nz-col [nzSpan]="4" class="ta_r">
        有效期限：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <span name="validateTime" class="showText">{{
          data.validateTime | recordtime
        }}</span>
      </div>

      <div nz-col [nzSpan]="4" class="ta_r">
        许可文号：
      </div>
      <div nz-col [nzSpan]="8" class="ta_l">
        <span name="licence" class="showText">{{ data.licence }}</span>
      </div>
    </div>

    <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
      <div nz-col [nzSpan]="4" class="ta_r">
        许可内容：
      </div>
      <div nz-col [nzSpan]="20" class="ta_l">
        <div class="showTextArea">{{ data.content }}</div>
      </div>
    </div>

    <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
      <div nz-col [nzSpan]="4" class="ta_r">
        许可条件：
      </div>
      <div nz-col [nzSpan]="20" class="ta_l">
        <div class="showTextArea">{{ data.permitCondition }}</div>
      </div>
    </div>

    <div nz-row class="ma_b20" [nzType]="'flex'" [nzAlign]="'top'">
      <div nz-col [nzSpan]="4" class="ta_r">
        审评承诺：
      </div>
      <div nz-col [nzSpan]="20" class="ta_l">
        <div class="showTextArea">{{ data.promise }}</div>
      </div>
    </div>

    <app-attachment
      [fileList]="fileList"
      [refid]="data.id"
      [isDisable]="isShow"
      [moduleName]="'核活动许可信息'"
    #child></app-attachment>
  </div>

  <div
    nz-row
    [nzType]="'flex'"
    [nzAlign]="'middle'"
    class="div_bottom_add"
    [nzJustify]="'end'"
  >
    <button
      nz-button
      nzType="primary"
      (click)="save()"
      *ngIf="!isShow"
      style="margin-right: 10px;"
      [nzLoading]="isSaving"
    >
      保存
    </button>
    <button nz-button nzType="default" (click)="close()">关闭</button>
  </div>
</div>
